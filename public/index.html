<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Stalker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #09090b; color: #fafafa; }
        .card { background-color: #18181b; border: 1px solid #27272a; }
        .input-field { background-color: #09090b; border: 1px solid #27272a; transition: all 0.2s; }
        .input-field:focus { border-color: #3f3f46; outline: none; }
        .btn-primary { background-color: #fafafa; color: #09090b; transition: all 0.2s; }
        .btn-primary:hover { background-color: #e4e4e7; }
        .btn-primary:disabled { background-color: #27272a; color: #52525b; }
        .skeleton { background-color: #27272a; animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="antialiased">

    <main class="max-w-5xl mx-auto px-6 py-16">
        <!-- Search Section -->
        <div class="max-w-xl mb-16">
            <h2 class="text-4xl font-semibold mb-4 tracking-tight">Instagram Stalker.</h2>
            <p class="text-zinc-400 mb-8 leading-relaxed text-sm">Cek profil Instagram siapapun secara anonim.</p>
            
            <div class="flex flex-col sm:flex-row gap-3">
                <input type="text" id="username" placeholder="Masukkan username IG..." 
                    class="input-field flex-1 px-4 py-3 rounded-md text-sm">
                <button onclick="doStalk()" id="btnSearch" class="btn-primary px-8 py-3 rounded-md font-bold text-sm uppercase tracking-tight">
                    Analyze
                </button>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden">
            <div class="card p-8 rounded-xl flex items-center gap-6 max-w-2xl">
                <div class="w-24 h-24 rounded-full skeleton"></div>
                <div class="space-y-3">
                    <div class="h-6 w-48 skeleton rounded"></div>
                    <div class="h-4 w-32 skeleton rounded"></div>
                </div>
            </div>
        </div>

        <!-- Result -->
        <div id="result" class="hidden">
            <div class="card p-8 rounded-2xl flex flex-col md:flex-row items-center md:items-start gap-8 max-w-2xl">
                <div class="relative">
                    <img id="avatar" src="" class="w-32 h-32 rounded-full border-2 border-zinc-800 object-cover shadow-2xl">
                    <div id="badge-verified" class="hidden absolute bottom-1 right-1 bg-blue-500 rounded-full p-1 border-2 border-[#18181b]">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293l-4 4a1 1 0 01-1.414 0l-2-2a1 1 0 111.414-1.414L9 10.586l3.293-3.293a1 1 0 111.414 1.414z"></path></svg>
                    </div>
                </div>
                
                <div class="flex-1 text-center md:text-left">
                    <div class="mb-4">
                        <div class="flex items-center justify-center md:justify-start gap-2">
                            <h2 id="nickname" class="text-2xl font-bold tracking-tight"></h2>
                            <span id="badge-private" class="hidden text-[10px] bg-zinc-800 text-zinc-400 px-2 py-0.5 rounded border border-zinc-700">PRIVATE</span>
                        </div>
                        <p id="user_id" class="text-zinc-500 font-medium"></p>
                    </div>
                    
                    <p id="bio" class="text-zinc-400 text-sm mb-6 whitespace-pre-wrap"></p>

                    <div class="grid grid-cols-3 gap-6 border-t border-zinc-800 pt-6">
                        <div>
                            <p class="text-[10px] uppercase text-zinc-500 font-bold mb-1">Posts</p>
                            <span id="posts" class="text-xl font-semibold">0</span>
                        </div>
                        <div>
                            <p class="text-[10px] uppercase text-zinc-500 font-bold mb-1">Followers</p>
                            <span id="followers" class="text-xl font-semibold">0</span>
                        </div>
                        <div>
                            <p class="text-[10px] uppercase text-zinc-500 font-bold mb-1">Following</p>
                            <span id="following" class="text-xl font-semibold">0</span>
                        </div>
                    </div>

                    <a id="ig-link" href="#" target="_blank" class="inline-block mt-8 text-xs text-zinc-500 hover:text-white underline decoration-zinc-700">
                        View on Instagram
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script>
        async function doStalk() {
            const user = document.getElementById('username').value.trim();
            const btn = document.getElementById('btnSearch');
            const resultDiv = document.getElementById('result');
            const loading = document.getElementById('loading');

            if(!user) return;

            btn.disabled = true;
            btn.innerText = 'Analyzing...';
            loading.classList.remove('hidden');
            resultDiv.classList.add('hidden');

            try {
                const response = await fetch(`/api/igstalk?user=${user}`);
                const data = await response.json();

                if(data.success) {
                    const res = data.result;
                    document.getElementById('avatar').src = res.avatar;
                    document.getElementById('nickname').innerText = res.fullName;
                    document.getElementById('user_id').innerText = '@' + res.username;
                    document.getElementById('bio').innerText = res.bio;
                    document.getElementById('posts').innerText = res.stats.posts;
                    document.getElementById('followers').innerText = res.stats.followers;
                    document.getElementById('following').innerText = res.stats.following;
                    document.getElementById('ig-link').href = `https://instagram.com/${res.username}`;

                    // Badges
                    document.getElementById('badge-verified').classList.toggle('hidden', !res.isVerified);
                    document.getElementById('badge-private').classList.toggle('hidden', !res.isPrivate);

                    resultDiv.classList.remove('hidden');
                } else {
                    alert(data.message);
                }
            } catch (e) {
                alert('Server Error');
            } finally {
                btn.disabled = false;
                btn.innerText = 'Analyze';
                loading.classList.add('hidden');
            }
        }

        document.getElementById("username").addEventListener("keyup", function(e) {
            if (e.key === "Enter") doStalk();
        });
    </script>
</body>
</html>
